name: release

on:
  workflow_dispatch:

jobs:
  release:
    strategy:
      matrix:
        product: [ "IC-193", "IC-201", "IC-202", "IC-203", "IC-211" ]
      max-parallel: 1
    env:
      PRODUCT_NAME: ${{ matrix.product }}
    runs-on: ubuntu-latest
    steps:
      -  name: Checkout the repo
         uses: actions/checkout@v2
         with:
           fetch-depth: 0

      -  uses: actions/setup-java@v1
         with:
           java-version: '11'
           java-package: jdk
           architecture: x64

      -  name: Deploy to JetBrains
         run: ./gradlew --stacktrace publishPlugin
         env:
           PRODUCT_NAME: ${{ matrix.product }}
           JETBRAINS_TOKEN: ${{ secrets.JETBRAINS_TOKEN }}
